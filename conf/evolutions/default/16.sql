# --- !Ups

CREATE TABLE leaving_reasons (
  id    SERIAL PRIMARY KEY,
  punkt TEXT NOT NULL UNIQUE,
  name  TEXT NOT NULL UNIQUE
);

INSERT INTO leaving_reasons (punkt, name)
VALUES ('ст. 80 Трудового Кодекса КР', 'Расторжение трудового договора по соглашению сторон'),
('ст. 81 Трудового Кодекса КР', 'Расторжение срочного трудового договора с истечением его срока'),
('ст. 82 Трудового Кодекса КР', 'Расторжение трудового договора по инициативе работника (по собственному желанию)
Расторжение трудового договора по инициативе работодателя'),
('п.1 ст. 83 Трудового Кодекса КР', 'Ликвидация организации (юридического лица), прекращения деятельности работодателя (физического лица)'),
('п.2 ст. 83 Трудового Кодекса КР', 'Сокращение численности или штата работников, в том числев связи с реорганизацией организации'),
('п.3.а ст. 83 Трудового Кодекса КР', 'Несоответсвие работника занимаемой должности или выполняемой работе вследствие состояния здоровья в соотвествие с медицинским заключением'),
('п.3.б ст. 83 Трудового Кодекса КР', 'Несоответсвие работника занимаемой должности или выполняемой работе вследствие недостаточной квалификации, подтвержденной результатами аттестации, справками о невыполнении норм труда, актами о выпуске брака и другими данными.'),
('п.4 ст. 83 Трудового Кодекса КР', 'Смена собственника имущества организации (в отношении руководителя организации, его заместителей и главного бухгалтера)'),
('п.5 ст. 83 Трудового Кодекса КР', 'Неоднократное неисполнение работником без уважительных причин трудовых обязанностей, если он имеет дисциплинарное взыскание'),
('п.6.а ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение работником трудовых обязанностей - прогул (отсуствие на работе более 3 часов подряд в течение рабочего дня без уважительных причин)'),
('п.6.б ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение работником трудовых обязанностей - появление на работе в состоянии алкогольного, наркотического или токсического опьянения. Такое состояние подтверждается медицинским заключением, свидетельскими показаниями или актом, составленным работодателем совместно с представительным органом работников.'),
('п.6.в ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение работником трудовых обязанностей - совершение по месту работы умышленной порчи или хищения имущества организации'),
('п.6.г ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение работником трудовых обязанностей - нарушение работником требований охраны труда, которое повлекло тяжкие последствия, включая травмы, авария'),
('п.6.д ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение работником трудовых обязанностей - разглашение государственной, служебной, коммерческой или иной охраняемой законом тайны, ставшей известной работнику в связи с исполнением трудовых обязанностей и если условие о ее сохранении предусмотрено в трудовом договоре.'),
('п.7 ст. 83 Трудового Кодекса КР', 'Совершение виновных действий работником, непосредственно обслуживающим денежные или товарные ценности, если эти действия дают основание для утраты доверия к нему со стороны работодателя'),
('п.8 ст. 83 Трудового Кодекса КР', 'Совершение работником, выполняющим воспитательные функции, аморального поступка, не совместимого с продолжением данной работы'),
('п.9 ст. 83 Трудового Кодекса КР', 'Принятие необоснованного решения руководителем организации (филиала, представительства), его заместителями и главным бухгалтером, повлекшего за собой нарушение сохранности, неправомерное использование или иной ущерб имуществу организации'),
('п.10 ст. 83 Трудового Кодекса КР', 'Представление работником работодателю подложных документов или заведомо ложных сведений при заключении трудового договора, если эти документы или сведения могли являться основанием для отказа в заключении трудового договора'),
('п.11 ст. 83 Трудового Кодекса КР', 'Однократное грубое нарушение руководителем организации (филиала, представительства), его заместителями своих трудовых обязанностей'),
('п.12 ст. 83 Трудового Кодекса КР', 'В других случаях, установленных настоящим Кодексом или иными законами'),
('ст. 84 Трудового Кодекса КР', 'Расторжение трудового договора по инициативе работодателя с предварительного согласия представительного органа работников Прекращение трудового договора по обстоятельствам, не зависящим от воли сторон'),
('п.1 ст. 88 Трудового Кодекса КР', 'Призыв работника на военную или заменяющую ее альтернативную службу, а также в связи с переводом супруга (супруги) на службу в другую местность'),
('п.2 ст. 88 Трудового Кодекса КР', 'Восстановление работника, который ранее выполнял эту работу, по решению государственной инспекции труда или суда'),
('п.3 ст. 88 Трудового Кодекса КР', 'Нарушение установленных правил приема на работу'),
('п.4 ст. 88 Трудового Кодекса КР', 'Осуждение работника к наказанию, исключающему продолжение прежней работы, в соотвествии с приговором суда, вступившим в законную силу'),
('п.5 ст. 88 Трудового Кодекса КР', 'Неизбрание на выборную должность'),
('п.6 ст. 88 Трудового Кодекса КР', 'Смерть работника либо работодателя - физического лица, а также признание судом работника или работодателя - физического лица умершим или безвестно отсуствующим'),
('п.7 ст. 88 Трудового Кодекса КР', 'Наступление чрезвычайных обстоятельств, препятствующих продолжению трудовых отношений (военные действия, катастрофа, стихийное бедствие и другие чрезвычайные обстоятельства), если данное обстоятельство признано решением Правительства КР
Прочие основания прекращения (расторжения) трудового договора'),
('ч.3 ст. 75 Трудового Кодекса КР', 'Отказ работника от перевода на другую работу вследствие состояния здоровья в соответствии с медицинским заключением'),
('ч.4 ст. 71 Трудового Кодекса КР', 'Отказ работника от продолжения работы в связи с изменением существенных условий труда'),
('ст. 77 Трудового Кодекса КР', 'Отказ работника от продолжения работы в организации в связи со сменой собственника, изменением ее подчиненности (подведомственности) и ее реорганизации'),
  ('ч.1 ст. 69 Трудового Кодекса КР',
   'Отказ работника от перевода в связи с перемещением работодателя в другую местность');


CREATE TABLE orders (
  id             BIGSERIAL PRIMARY KEY,
  name           TEXT,
  order_category INT,
  nomer          INT,
  date_of_order  DATE,
  content        TEXT,
  tags           TEXT
);

CREATE TABLE order_tags (
  id    TEXT UNIQUE,
  count INT
);

CREATE TABLE employment_orders (
  id                 BIGSERIAL PRIMARY KEY,
  position_id        INT,
  contract_type_id   INT,
  employee_id        BIGINT,
  salary             NUMERIC(14, 2),
  calendar_type_id   SMALLINT,
  contract_number INT,
  trial_period_start DATE,
  trial_period_end   DATE,
  start_date         DATE,
  end_date           DATE,
  close_date         DATE,
  created_at         TIMESTAMP NOT NULL,
  updated_at         TIMESTAMP NOT NULL
);

CREATE TABLE dismissal_orders (
  id                BIGSERIAL PRIMARY KEY,
  employee_id       BIGINT    NOT NULL,
  leaving_reason_id INT       NOT NULL,
  comment           TEXT,
  leaving_date      DATE,
  created_at        TIMESTAMP NOT NULL,
  updated_at        TIMESTAMP NOT NULL
);

CREATE TABLE positions (
  id                  BIGSERIAL PRIMARY KEY,
  employment_order_id BIGINT,
  position_id         INT,
  employee_id         BIGINT,
  dismissal_order_id  BIGINT,
  start_date          DATE,
  end_date            DATE,
  close_date          DATE,
  created_at          TIMESTAMP NOT NULL,
  updated_at          TIMESTAMP NOT NULL
);


  # -- !Downs
DROP TABLE IF EXISTS leaving_reasons CASCADE;
DROP SEQUENCE IF EXISTS leaving_reasons_id_seq;
DROP TABLE IF EXISTS positions CASCADE;
DROP SEQUENCE IF EXISTS positions_id_seq;
DROP TABLE IF EXISTS orders CASCADE;
DROP SEQUENCE IF EXISTS orders_id_seq;
DROP TABLE IF EXISTS employment_orders CASCADE;
DROP SEQUENCE IF EXISTS employment_orders_id_seq;
DROP TABLE IF EXISTS dismissal_orders CASCADE;
DROP SEQUENCE IF EXISTS dismissal_orders_id_seq;
DROP TABLE IF EXISTS order_tags CASCADE;
